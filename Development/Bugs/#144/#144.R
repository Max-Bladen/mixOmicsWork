# ---------------------------------------------------------------------------- #
# ============================= PACKAGE VERSIONS ============================= #
# ---------------------------------------------------------------------------- #

library(mixOmics)

# ---------------------------------------------------------------------------- #

library(devtools)
setwd("C:/Users/Work/Desktop/mixOmics/R")

load_all()

# ---------------------------------------------------------------------------- #
# =============================== LOAD IN DATA =============================== #
# ---------------------------------------------------------------------------- #

data(nutrimouse)
Y = nutrimouse$diet
set.seed(42)
Y <- factor(Y, levels = sample(levels((Y))), ordered = TRUE)
Y
data = list(gene = nutrimouse$gene, lipid = nutrimouse$lipid)


# ---------------------------------------------------------------------------- #
# =========================== CASES WITH NO ERROR ============================ #
# ---------------------------------------------------------------------------- #

nutrimouse.sgccda <- block.splsda(X = data,
                                  Y = Y,
                                  design = 'full',
                                  keepX = list(gene = c(10,10), lipid = c(15,15)),
                                  ncomp = 5,
                                  scheme = "centroid")
plotIndiv(nutrimouse.sgccda, legend = TRUE)
cimDiablo(nutrimouse.sgccda)

# ---------------------------------------------------------------------------- #
# ============================= CASES WITH ERROR ============================= #
# ---------------------------------------------------------------------------- #

